"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1816],{30439:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>h});var s=n(24246),i=n(71670);const r={},o=void 0,a={id:"my/public/software/architecture/auth",title:"auth",description:"authentication",source:"@site/docs/my/public/software/architecture/auth.md",sourceDirName:"my/public/software/architecture",slug:"/my/public/software/architecture/auth",permalink:"/note/docs/my/public/software/architecture/auth",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"auth-openID",permalink:"/note/docs/my/public/software/architecture/auth-openID"},next:{title:"authorization",permalink:"/note/docs/my/public/software/architecture/authorization"}},l={},h=[{value:"authentication",id:"authentication",level:2},{value:"OAuth",id:"oauth",level:2},{value:"OpenID",id:"openid",level:3},{value:"lib",id:"lib",level:4},{value:"SSO",id:"sso",level:2}];function c(e){const t={a:"a",blockquote:"blockquote",br:"br",cite:"cite",h2:"h2",h3:"h3",h4:"h4",ins:"ins",li:"li",p:"p",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"authentication",children:"authentication"}),"\n",(0,s.jsxs)(t.p,{children:["SAML is a SOAP-based standard, and is known for being fairly complex",(0,s.jsx)(t.br,{}),"\nto work with despite the libraries and tooling available to support",(0,s.jsx)(t.br,{}),"\nit. ",(0,s.jsx)(t.a,{href:"http://en.m.wikipedia.org/wiki/OpenID",children:"http://en.m.wikipedia.org/wiki/OpenID"})," Connect is a standard that has emerged as a specific",(0,s.jsx)(t.br,{}),"\nimplementation of OAuth 2.0, based on the way Google and others handle",(0,s.jsx)(t.br,{}),"\nSSO. It uses simpler REST calls, and in my opinion is likely to make",(0,s.jsx)(t.br,{}),"\ninroads into enterprises due to its improved ease of use. Its biggest",(0,s.jsx)(t.br,{}),"\nstumbling block right now is the lack of identity providers that",(0,s.jsx)(t.br,{}),"\nsupport it. For a public-facing website, you might be OK using Google",(0,s.jsx)(t.br,{}),"\nas your provider, but for internal systems or systems where you want",(0,s.jsx)(t.br,{}),"\nmore control over and visibility into how and where your data is",(0,s.jsx)(t.br,{}),"\ninstalled, you\u2019ll want your own in-house identity provider. At the",(0,s.jsx)(t.br,{}),"\ntime of writing (2015), OpenAM and Gluu are two of the very few options",(0,s.jsx)(t.br,{}),"\navailable in this space, compared to a wealth of options for SAML",(0,s.jsx)(t.br,{}),"\n(including Active Directory, which seems to be everywhere). Until and",(0,s.jsx)(t.br,{}),"\nunless existing identity providers start supporting OpenID Connect,",(0,s.jsx)(t.br,{}),"\nits growth may be limited to those situations where people are happy",(0,s.jsx)(t.br,{}),"\nusing a public identity provider."]}),"\n",(0,s.jsx)(t.p,{children:"2021 OpenID seem still very lacking (for average consumer)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"http://en.m.wikipedia.org/wiki/OAuth",children:"http://en.m.wikipedia.org/wiki/OAuth"})," is an authorization protocol, rather than an authentication protocol.",(0,s.jsx)(t.br,{}),"\nuser authorizes (or delegates to) a 3rd-party app"]}),"\n",(0,s.jsxs)(t.p,{children:["The extensibility and modularity of OAuth 2.0 form one of its greatest",(0,s.jsx)(t.br,{}),"\nassets, since it allows the protocol to be used in a wide variety of",(0,s.jsx)(t.br,{}),"\nenvironments. However, this same flexibility leads to basic",(0,s.jsx)(t.br,{}),"\nincompatibility problems between implementations. OAuth leaves many",(0,s.jsx)(t.br,{}),"\npieces optional, which can confuse developers who are trying to",(0,s.jsx)(t.br,{}),"\nimplement it between two systems."]}),"\n",(0,s.jsxs)(t.p,{children:["the fact that a system implements OAuth, and even implements it",(0,s.jsx)(t.br,{}),"\ncorrectly according to the spec, doesn\u2019t mean that this system is",(0,s.jsx)(t.br,{}),"\nsecure in practice.",(0,s.jsx)(t.br,{}),"\nUltimately, OAuth 2.0 is a good protocol, but it\u2019s far from perfect.",(0,s.jsx)(t.br,{}),"\nWe will see its replacement at some point in the future, as with all",(0,s.jsx)(t.br,{}),"\nthings in technology, but no real contender has yet emerged as of 201703."]}),"\n",(0,s.jsxs)(t.p,{children:["User Managed Access protocol uses OAuth to create a system capable of",(0,s.jsx)(t.br,{}),"\nuser-to-user delegation.",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.a,{href:"https://learning.oreilly.com/library/view/oauth-2-in/9781617293276/kindle_split_011.html",children:"Chapter 1 What is OAuth 2 0 and why should you care OAuth 2 in Act at 20191112"})]}),"\n",(0,s.jsxs)(t.p,{children:["Client Certificates",(0,s.jsx)(t.br,{}),"\nThe operational challenges here in certificate management are even",(0,s.jsx)(t.br,{}),"\nmore onerous than with just using server-side certificates."]}),"\n",(0,s.jsxs)(t.p,{children:["An alternative approach, as used extensively by Amazon\u2019s S3 APIs for",(0,s.jsx)(t.br,{}),"\nAWS and in parts of the OAuth specification, is to use a hash-based",(0,s.jsx)(t.br,{}),"\nmessaging code (HMAC) to sign the request.",(0,s.jsx)(t.br,{}),"\nWith HMAC the body request along with a private key is hashed, and",(0,s.jsx)(t.br,{}),"\nthe resulting hash is sent along with the request. The server then",(0,s.jsx)(t.br,{}),"\nuses its own copy of the private key and the request body to re-create",(0,s.jsx)(t.br,{}),"\nthe hash. If it matches, it allows the request.",(0,s.jsx)(t.br,{}),"\nthis approach ensures only that no third party has manipulated the",(0,s.jsx)(t.br,{}),"\nrequest and that the private key itself remains private. The rest of",(0,s.jsx)(t.br,{}),"\nthe data in the request will still be visible to parties snooping on",(0,s.jsx)(t.br,{}),"\nthe network."]}),"\n",(0,s.jsx)(t.p,{children:"All public APIs from services like Twitter, Google, Flickr, and AWS make use of API keys."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://learning.oreilly.com/library/view/building-microservices/9781491950340/ch09.html",children:"9 Security Building Microservices"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://developer.twitter.com/en/docs/authentication/overview",children:"https://developer.twitter.com/en/docs/authentication/overview"}),(0,s.jsx)(t.br,{}),"\ngood to model after?"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"http://stackoverflow.com/questions/3817744",children:"Database Schema for multiple authentications Facebook Connect Twitte"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.a,{href:"http://stackoverflow.com/questions/9846465",children:"mysql Database Schema allowing for multiple login opportunities Fac"})]}),"\n",(0,s.jsxs)(t.p,{children:["good overview:",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.a,{href:"https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/",children:"https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/"}),(0,s.jsx)(t.br,{}),"\nauth0 rotates refresh key, without which use a blocklist to logout refresh token (ignore short-lived access token)"]}),"\n",(0,s.jsx)(t.h2,{id:"oauth",children:"OAuth"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n  ",(0,s.jsx)(t.p,{style:{},children:"\n"}),(0,s.jsx)(t.p,{children:"the only thing it handles is authorization, it does not support\nend-user authentication by itself (like buying a ticket (authorization)\nfor a show, but no authentication who I am)"}),"\n  ",(0,s.jsx)(t.p,{}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://learning.oreilly.com/library/view/microservices-patterns/9781617294549/kindle_split_019.html",children:"Chapter 11 Developing production ready services Microservices Patte"})}),"\n",(0,s.jsxs)(t.p,{children:["jwt-handbook-v0_14_1.pdf",(0,s.jsx)(t.br,{}),'\n"competing OAuth2 implementations may not be interoperable. For',(0,s.jsx)(t.br,{}),"\ninstance, the actual binary format of the tokens is not specified.",(0,s.jsx)(t.br,{}),"\nTheir purpose and functionality is."]}),"\n",(0,s.jsx)(t.p,{children:"Access tokens   (issued by Auth-server or by RP-server?)"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"validated by the resource server on its own"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Refresh tokens    request new access tokens,  usually long-lived"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"require access to the authorization server  (more complex)"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Although OAuth2 makes no mention of the format of its tokens, JWTs are",(0,s.jsx)(t.br,{}),"\na good match for its requirements. Signed JWTs make good access",(0,s.jsx)(t.br,{}),"\ntokens, as they can encode all the necessary data to differentiate",(0,s.jsx)(t.br,{}),"\naccess levels to a resource, can carry an expiration date, and are",(0,s.jsx)(t.br,{}),"\nsigned to avoid validation queries against the authorization server.",(0,s.jsx)(t.br,{}),"\nSeveral federated identity providers issue access tokens in JWT",(0,s.jsx)(t.br,{}),"\nformat. JWTs may also be used for refresh tokens. There is less reason",(0,s.jsx)(t.br,{}),"\nto use them for this purpose, though. As refresh tokens require access",(0,s.jsx)(t.br,{}),"\nto the authorization server, most of the time a simple UUID will",(0,s.jsx)(t.br,{}),"\nsuffice, as there is no need for the token to carry a payload (it may",(0,s.jsx)(t.br,{}),"\nbe signed, though)."]}),"\n",(0,s.jsxs)(t.p,{children:["OpenID Connect is a standardization effort to bring typical use",(0,s.jsx)(t.br,{}),"\ncases of OAuth2 under a common, well-defined spec. As many details",(0,s.jsx)(t.br,{}),"\nbehind OAuth2 are left to the choice of implementers, OpenID Connect",(0,s.jsx)(t.br,{}),"\nattempts to provide proper definitions for the missing parts.",(0,s.jsx)(t.br,{}),"\nSpecifically, OpenID Connect defines an API and data format to perform",(0,s.jsx)(t.br,{}),"\nOAuth2 authorization flows. Additionally, it provides an",(0,s.jsx)(t.br,{}),"\nauthentication layer built on top of this flow. The data format chosen",(0,s.jsx)(t.br,{}),"\nfor some of its parts is JSON Web Token.",(0,s.jsx)(t.br,{}),'\n"']}),"\n",(0,s.jsx)(t.h3,{id:"openid",children:"OpenID"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{style:{},children:"\nIn March 2018, Stack Overflow announced an end to OpenID support,\nciting insufficient usage to justify the cost. In the announcement, it\nwas stated that based on activity, users strongly preferred Facebook,\nGoogle, and e-mail/password based account authentication\n"}),(0,s.jsx)(t.p,{children:(0,s.jsx)(t.ins,{children:" so only large providers like Google lives on? "})}),"\n",(0,s.jsx)(t.p,{}),"\n",(0,s.jsx)(t.cite,{children:"\nhttps://en.m.wikipedia.org/wiki/OpenID\n"}),"\n"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\nSAML and OpenID Connect will likely coexist for quite some time, with each being deployed in situations where they make sense.  \n",(0,s.jsx)(t.p,{children:"Security Assertion Markup Language (SAML)"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"XML-based federation technology used in some enterprise and academic cases"}),"\n",(0,s.jsx)(t.li,{children:"only for Web-based applications"}),"\n",(0,s.jsx)(t.li,{children:"exchanging auth-data between different security domains"}),"\n",(0,s.jsx)(t.li,{children:"too heavy and too powerful for most scenarios"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"OpenID Connect has many architectural similarities to OpenID 2.0, and\nin fact solve a very similar set of problems."}),"\n",(0,s.jsx)(t.p,{children:"OpenID 2.0"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"used XML and a custom message signature scheme that in practice sometimes proved difficult"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"OpenID Connect"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"uses Web\u2019s built-in TLS (also called HTTPS or SSL) infrastructure (vs. SAML), which enormously simplifies things"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"uses standard JSON Web Token (JWT) data structures"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"better interoperability"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"native apps and mobile applications"}),"\n",(0,s.jsx)(t.cite,{children:"\n"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://openid.net/developers/how-connect-works/",children:"https://openid.net/developers/how-connect-works/"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"lib",children:"lib"}),"\n",(0,s.jsxs)(t.p,{children:["find in ",(0,s.jsx)(t.a,{href:"https://openid.net/certification/",children:"https://openid.net/certification/"})]}),"\n",(0,s.jsx)(t.h2,{id:"sso",children:"SSO"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Single_sign-on",children:"https://en.wikipedia.org/wiki/Single_sign-on"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/SAML_2.0",children:"https://en.wikipedia.org/wiki/SAML_2.0"}),(0,s.jsx)(t.br,{}),"\nChrome extension helpful in debugging: ",(0,s.jsx)(t.a,{href:"https://chrome.google.com/webstore/detail/saml-tracer/mpdajninpobndbfcldcmbpnnbhibjmch",children:"https://chrome.google.com/webstore/detail/saml-tracer/mpdajninpobndbfcldcmbpnnbhibjmch"})]})]})}function d(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},71670:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>o});var s=n(27378);const i={},r=s.createContext(i);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);